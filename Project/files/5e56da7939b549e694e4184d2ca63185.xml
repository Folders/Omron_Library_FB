<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class Graph_InfoAndSetpoint_Units&#xD;
</HiddenHeader><SerialData i:nil="true"/><SerialDeviceHmiId i:nil="true"/><SerialScaleData i:nil="true"/><Text>'IAG Code behind - Add local subroutines for the IAG.&#xD;
Sub Metric&#xD;
	&#xD;
	FeedbackOutput = FeedbackInternal&#xD;
	SP_Max_Out = SP_Max_Intern&#xD;
	SP_Min_Out = SP_Min_Intern&#xD;
	&#xD;
End Sub&#xD;
&#xD;
Sub US&#xD;
	&#xD;
	If UnitMetric = "°C" And UnitUS = "°F" Then&#xD;
		FeedbackOutput = FeedbackInternal * 1.8 + 32&#xD;
		SP_Max_Out = SP_Max * 1.8 + 32&#xD;
		SP_Min_Out = SP_Min * 1.8 + 32&#xD;
	ElseIf UnitMetric = "mm" And UnitUS = "inch" Then&#xD;
		FeedbackOutput = FeedbackInternal * 0.03937&#xD;
		SP_Max_Out = SP_Max * 0.03937&#xD;
		SP_Min_Out = SP_Min * 0.03937		&#xD;
	ElseIf UnitMetric = "bar" And UnitUS = "psi" Then&#xD;
		FeedbackOutput = FeedbackInternal * 14.5038&#xD;
		SP_Max_Out = SP_Max * 14.5038&#xD;
		SP_Min_Out = SP_Min * 14.5038&#xD;
	ElseIf UnitMetric = "mbar" And UnitUS = "inch" Then&#xD;
		FeedbackOutput = FeedbackInternal * 0.409&#xD;
		SP_Max_Out = SP_Max * 0.409&#xD;
		SP_Min_Out = SP_Min * 0.409&#xD;
	Else&#xD;
		FeedbackOutput = FeedbackInternal&#xD;
		SP_Max_Out = SP_Max&#xD;
		SP_Min_Out = SP_Min&#xD;
	End If&#xD;
		&#xD;
End Sub&#xD;
&#xD;
Sub Refresh	&#xD;
&#xD;
	FeedbackInternal = Feedback	&#xD;
	SP_Max_Intern = SP_Max&#xD;
	SP_Min_Intern = SP_Min&#xD;
	If UnitChoice Then&#xD;
		Call US&#xD;
	Else&#xD;
		Call Metric&#xD;
	End If&#xD;
		&#xD;
End Sub&#xD;
&#xD;
Sub SetpointChange&#xD;
	&#xD;
	SetpointInternal = Setpoint&#xD;
			If UnitMetric = "°C" And UnitUS = "°F" Then&#xD;
				SetpointUS = Setpoint * 1.8 + 32&#xD;
			ElseIf UnitMetric = "mm" And UnitUS = "inch" Then&#xD;
				SetpointUS = Setpoint * 0.03937&#xD;
			ElseIf UnitMetric = "bar" And UnitUS = "psi" Then&#xD;
				SetpointUS = Setpoint * 14.5038&#xD;
			ElseIf UnitMetric = "mbar" And UnitUS = "inch" Then				&#xD;
				SetpointUS = Setpoint * 0.409&#xD;
			Else&#xD;
				SetpointUS = Setpoint&#xD;
			End If&#xD;
&#xD;
End Sub&#xD;
&#xD;
Sub SetpointInput&#xD;
	&#xD;
		If UnitChoice Then&#xD;
			If UnitMetric = "°C" And UnitUS = "°F" Then&#xD;
				Setpoint = (SetpointUS - 32)/1.8&#xD;
			ElseIf UnitMetric = "mm" And UnitUS = "inch" Then&#xD;
				Setpoint = SetpointUS/0.03937&#xD;
			ElseIf UnitMetric = "bar" And UnitUS = "psi" Then&#xD;
				Setpoint = SetpointUS/14.5038&#xD;
			ElseIf UnitMetric = "mbar" And UnitUS = "inch" Then&#xD;
				Setpoint = SetpointUS/0.409&#xD;
			Else&#xD;
				Setpoint = SetpointUS&#xD;
			End If&#xD;
			SetpointInternal = Setpoint&#xD;
			&#xD;
		Else&#xD;
			SetpointInternal = Setpoint&#xD;
			If UnitMetric = "°C" And UnitUS = "°F" Then&#xD;
				SetpointUS = Setpoint * 1.8 + 32&#xD;
			ElseIf UnitMetric = "mm" And UnitUS = "inch" Then&#xD;
				SetpointUS = Setpoint * 0.03937&#xD;
			ElseIf UnitMetric = "bar" And UnitUS = "psi" Then&#xD;
				SetpointUS = Setpoint * 14.5038&#xD;
			ElseIf UnitMetric = "mbar" And UnitUS = "inch" Then&#xD;
				SetpointUS = Setpoint * 0.409&#xD;
			Else&#xD;
				SetpointUS = Setpoint&#xD;
			End If&#xD;
		End If&#xD;
	&#xD;
End Sub&#xD;
&#xD;
</Text></CodeEditorModel>